"use strict";(globalThis["webpackChunkpizzarree"]=globalThis["webpackChunkpizzarree"]||[]).push([[939],{3939:(e,t,a)=>{a.r(t),a.d(t,{default:()=>C});var o=a(9835),l=a(1957),s=a(6970);const n={class:"tw-font-bold tw-text-3xl"},i={class:"justify-between row full-width"};function r(e,t,a,r,u,p){const d=(0,o.up)("q-input"),c=(0,o.up)("q-step"),m=(0,o.up)("q-icon"),w=(0,o.up)("q-item-label"),f=(0,o.up)("q-item-section"),g=(0,o.up)("q-item"),v=(0,o.up)("q-select"),h=(0,o.up)("q-btn"),b=(0,o.up)("q-stepper-navigation"),_=(0,o.up)("q-stepper"),y=(0,o.up)("q-form"),k=(0,o.up)("user-access-card");return(0,o.wg)(),(0,o.j4)(k,{form:1==r.step?r.validateStepForm:r.loginForm,loading:r.loading,actionText:1==r.step?"user.login":""},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{class:"q-gutter-md",onSubmit:(0,l.iM)(r.handleSubmit,["prevent"])},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{modelValue:r.step,"onUpdate:modelValue":t[7]||(t[7]=e=>r.step=e),contracted:"","header-class":"tw-hidden",color:"primary",animated:"",bordered:!1,flat:""},{navigation:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,s.C_)(["column",1==r.step?"tw-mt-14":""])},[(0,o._)("div",i,[1==r.step?((0,o.wg)(),(0,o.j4)(h,{key:0,type:"reset",color:"primary",to:{name:"Register"},flat:"","no-caps":"",dense:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(r.capitalize(e.$t("create"))+" "+e.$t("account")),1)])),_:1})):(0,o.kq)("",!0),2==r.step?((0,o.wg)(),(0,o.j4)(h,{key:1,color:"primary",flat:"","no-caps":"",dense:"",to:{name:"PasswordReset"}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(r.capitalize(e.$t("forgot"))+" "+e.$t("user.password"))+" ? ",1)])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(h,{label:1==r.step?r.capitalize(e.$t("next")):r.capitalize(e.$t("user.login")),type:"submit",color:"primary",loading:r.loading,"no-caps":""},null,8,["label","loading"])])],2)])),_:1})])),default:(0,o.w5)((()=>[(0,o.Wm)(c,{name:1,title:"",done:r.step>1},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{outlined:"",modelValue:r.validateStepForm.username,"onUpdate:modelValue":t[0]||(t[0]=e=>r.validateStepForm.username=e),type:"text",name:"username",label:e.$t("user.username"),hint:r.capitalize(e.$t("user.login_hint")),error:r.validateStepForm.errors.has("username"),"error-message":r.validateStepForm.errors.get("username"),rules:[r.requiredField],"lazy-rules":"ondemand",autocomplete:"",autofocus:"",autocorrect:"off",spellcheck:"false",disable:r.loading},null,8,["modelValue","label","hint","error","error-message","rules","disable"])])),_:1},8,["done"]),(0,o.Wm)(c,{name:2,title:"login",done:r.step>2},{default:(0,o.w5)((()=>[2==r.step?((0,o.wg)(),(0,o.iD)("div",{class:"flex items-center content-center justify-center column tw-mt-0 tw-mb-8",key:r.step+1},[(0,o._)("p",n,(0,s.zw)(r.capitalize(e.$t("welcome"))),1),(0,o.Wm)(v,{modelValue:r.store.potentialUsername,"onUpdate:modelValue":t[2]||(t[2]=e=>r.store.potentialUsername=e),options:r.store.potentialUsers,dense:"",rounded:"",outlined:"","item-aligned":"","options-dense":"",autofocus:!1,onPopupShow:t[3]||(t[3]=e=>r.switchIcons=!0),onPopupHide:t[4]||(t[4]=e=>r.switchIcons=!1)},{prepend:(0,o.w5)((()=>[(0,o.Wm)(m,{name:r.switchIcons?"o_add":"o_account_circle",class:(0,s.C_)(r.switchIcons?"tw-text-green-500 cursor-pointer":"cursor-pointer"),onClick:t[1]||(t[1]=(0,l.iM)((e=>{r.step=1,r.switchIcons=!1}),["prevent"]))},null,8,["name","class"])])),option:(0,o.w5)((({itemProps:e,opt:t,selected:a,toggleOption:n})=>[(0,o.Wm)(g,(0,s.vs)((0,o.F4)(e)),{default:(0,o.w5)((()=>[(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(t),1)])),_:2},1024)])),_:2},1024),(0,o.Wm)(f,{side:""},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{name:"o_remove",class:"cursor-pointer tw-text-red-500","model-value":a,"onUpdate:modelValue":e=>n(t),onClick:(0,l.iM)((e=>r.store.unsetPotentialUsers(t)),["prevent"])},null,8,["model-value","onUpdate:modelValue","onClick"])])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","options"])])):(0,o.kq)("",!0),(0,o.Wm)(d,{outlined:"",modelValue:r.loginForm.password,"onUpdate:modelValue":t[6]||(t[6]=e=>r.loginForm.password=e),type:r.isPwd?"password":"text",label:e.$t("user.password"),autocomplete:"",autocorrect:"off",spellcheck:"false",autofocus:"",disable:r.loading,rules:[r.requiredField],"lazy-rules":"ondemand"},{append:(0,o.w5)((()=>[(0,o.Wm)(m,{name:r.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:t[5]||(t[5]=e=>r.isPwd=!r.isPwd)},null,8,["name"])])),_:1},8,["modelValue","type","label","disable","rules"])])),_:1},8,["done"])])),_:1},8,["modelValue"])])),_:1},8,["onSubmit"])])),_:1},8,["form","loading","actionText"])}a(2879);var u=a(6827),p=a(499),d=a(6501),c=a(7615),m=a(6928),w=a(8339),f=a(321),g=a(6647);const v="api/v1/accounts/api-token-auth/validate/",h="api/v1/accounts/api-auth-token/",b="api/v1/accounts/api-auth-user/profile/",_={name:"LoginPage",components:{UserAccessCard:c.Z},setup(){const{capitalize:e}=f["default"],{t}=(0,g.QT)(),a=(0,m.t)(),l=(0,w.tv)(),s=(0,w.yj)(),n=(0,p.ref)(!1),i=(0,p.ref)(!0),r=(0,p.ref)(1),c=(0,p.shallowRef)(!1),_=(0,p.reactive)(new d["default"]({username:""})),y=(0,p.reactive)(new d["default"]({username:a.potentialUsername,password:""})),k=async()=>{n.value=!0,1==r.value?await _.post(v).then((async({checks:e,username:t})=>{JSON.parse(e)&&await a.setPotenialUser(t)})).catch((e=>e)):await a.logIn(y,h)},q=e=>e&&e.length>0||t("required_field");return _.onSuccess=async()=>{r.value=2,y.username=_.username},y.onSuccess=async()=>{y.reset(),await l.push(s.query.redirect||{name:"Dashboard"}),await a.getProfileData(b),u.Z.create({type:"positive",message:`${t("user.welcome_back")}, ${e(a.authUser.username)}`,position:"top",progress:!0,multiLine:!0,icon:"o_waving_hand",iconSize:"2.5rem",iconColor:"yellow-7"})},y.onFinished=_.onFinished=()=>{n.value=!1},a.potentialUsername&&1==r.value&&(_.username=a.potentialUsername,r.value=2),(0,o.YP)((()=>a.potentialUsername),(e=>{e?y.username=e:(r.value=1,c.value=!1)})),{isPwd:i,loginForm:y,handleSubmit:k,loading:n,requiredField:q,capitalize:e,step:r,validateStepForm:_,switchIcons:c,store:a}}};var y=a(1639),k=a(8326),q=a(8225),S=a(8335),U=a(6611),z=a(1104),F=a(2857),W=a(490),P=a(6749),V=a(3115),Z=a(1992),I=a(4455),Q=a(9984),$=a.n(Q);const x=(0,y.Z)(_,[["render",r]]),C=x;$()(_,"components",{QForm:k.Z,QStepper:q.Z,QStep:S.Z,QInput:U.Z,QSelect:z.Z,QIcon:F.Z,QItem:W.Z,QItemSection:P.Z,QItemLabel:V.Z,QStepperNavigation:Z.Z,QBtn:I.Z})}}]);