"use strict";(globalThis["webpackChunkpizzarree"]=globalThis["webpackChunkpizzarree"]||[]).push([[620],{7620:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var r=a(9835),s=a(6970),n=a(1957);const l={key:0},i={key:0,class:"text-h5 tw-text-green-400"},o={class:"text-h5 tw-mt-2"},u={ref:"paymentElement"};function c(e,t,a,c,m,d){const p=(0,r.up)("q-item-label"),w=(0,r.up)("q-img"),g=(0,r.up)("q-item-section"),y=(0,r.up)("q-item"),h=(0,r.up)("q-separator"),v=(0,r.up)("q-card"),f=(0,r.up)("q-banner"),_=(0,r.up)("q-btn"),k=(0,r.up)("q-form"),b=(0,r.up)("q-page-container");return(0,r.wg)(),(0,r.j4)(b,{class:"col row flex justify-evenly items-start tw-gap-10"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,{class:"q-pa-lg col-sm-5 col-md-4 col-xs-10"},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{header:""},{default:(0,r.w5)((()=>[(0,r.Uk)("Order# "+(0,s.zw)(e.order.id)+" Summary",1)])),_:1}),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.store.cart,((e,t)=>((0,r.wg)(),(0,r.iD)(r.HY,{key:t},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.items,(a=>((0,r.wg)(),(0,r.j4)(y,{key:a.id+t},{default:(0,r.w5)((()=>[(0,r.Wm)(g,{avatar:""},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{src:a[0].cover_image,fit:"scale-down",height:"4rem"},null,8,["src"])])),_:2},1024),(0,r.Wm)(g,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,s.zw)(a[0].name)+" ",1),a.length>1?((0,r.wg)(),(0,r.j4)(p,{key:0,caption:""},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a,(e=>((0,r.wg)(),(0,r.iD)(r.HY,{key:e.id},[e!==a[0]?((0,r.wg)(),(0,r.iD)("div",l,(0,s.zw)(e.name),1)):(0,r.kq)("",!0)],64)))),128))])),_:2},1024)):(0,r.kq)("",!0)])),_:2},1024),(0,r.Wm)(g,{side:""},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{caption:""},{default:(0,r.w5)((()=>[(0,r.Uk)((0,s.zw)(e.quantity),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))],64)))),128)),(0,r.Wm)(h,{spaced:""}),e.order.discount_value?((0,r.wg)(),(0,r.iD)("div",i,"Discounts "+(0,s.zw)(e.order.discount_value),1)):(0,r.kq)("",!0),(0,r._)("div",o,"Total "+(0,s.zw)(e.order.total_cost),1)])),_:1}),(0,r.Wm)(v,{class:"q-pa-lg"},{default:(0,r.w5)((()=>[e.errors?((0,r.wg)(),(0,r.j4)(f,{key:0,rounded:"",class:"bg-negative q-mb-lg"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,s.zw)(e.errors),1)])),_:1})):(0,r.kq)("",!0),(0,r.Wm)(k,{class:"column",onSubmit:(0,n.iM)(e.handleSubmit,["prevent"])},{default:(0,r.w5)((()=>[(0,r._)("div",u,null,512),(0,r.Wm)(_,{type:"submit",align:"center",color:"accent",stretch:"",label:"Pay Now",class:"q-mt-lg",disable:e.processing},null,8,["disable"])])),_:1},8,["onSubmit"])])),_:1})])),_:1})}a(2879);var m=a(499),d=a(9349),p=a(9524),w=a(1809),g=a(9114),y=a(6827),h=a(1569),v=a(8339);const f="pk_test_RUZqAN8CkTK39VGr7FuIxPWE",_=(0,r.aZ)({name:"CheckoutComponent",async setup(){const e=(0,p.M)();let{order:t}=(0,w.Jk)(e);const a=(0,v.tv)(),s=(0,m.ref)(null),n=(0,m.ref)(!1),l=(0,m.ref)(null),i=e=>{n.value=!1,s.value=e};let o,u;(0,r.bv)((async()=>{t.value.id&&(u=await(0,d.J)(f,{})),o=await u.elements({mode:"payment",amount:Math.round(100*t.value.total_cost?.toFixed(2)),currency:"usd",paymentMethodCreation:"manual",appearance:{theme:g.Z.isActive?"night":"stripe"}});const a=await o.create("payment",{layout:{type:"tabs"}});a.mount(l.value),e.stripe=u,e.elements=o}));const c=async e=>{n.value=!0;const{error:a}=await o.submit();if(a)return i(a.message);const{error:r,paymentMethod:s}=await u.createPaymentMethod({elements:o,params:{billing_details:{address:{},name:"guest-user",email:t.value.email,phone:t.value.phone}}});if(r)return i(r.message);await h.api.post(`api/v1/shop/payment/checkout/${t.value.id}/`,{paymentMethodId:s.id}).then((async e=>{await _(e)})).catch((e=>i(e.message))),n.value=!1},_=async t=>{if(t.data&&t.data.error)return i(t.data.error);if("requires_action"===t.status||"requires_action"===t.data?.intent_status){const{error:a,paymentIntent:r}=await u.handleNextAction({clientSecret:t.client_secret||t.data?.client_secret});if(a)return i(a.message);y.Z.create({type:"positive",message:"Payment successful",closeBtn:!0}),await e.clearCart()}else y.Z.create({type:"positive",message:"Payment successful",closeBtn:!0}),await e.clearCart()};return t.value.id?{handleSubmit:c,errors:s,processing:n,order:t,store:e,paymentElement:l}:(await a.push({name:"Menu"}),s.value="seems that your cart is empty!",{errors:s,handleSubmit:c,processing:n,store:e})}});var k=a(1639),b=a(2133),q=a(4458),Z=a(3115),W=a(490),z=a(6749),C=a(335),Q=a(926),S=a(7128),x=a(8326),D=a(4455),M=a(9984),I=a.n(M);const P=(0,k.Z)(_,[["render",c]]),j=P;I()(_,"components",{QPageContainer:b.Z,QCard:q.Z,QItemLabel:Z.Z,QItem:W.Z,QItemSection:z.Z,QImg:C.Z,QSeparator:Q.Z,QBanner:S.Z,QForm:x.Z,QBtn:D.Z})}}]);